<?xml version="1.0"?>
<!DOCTYPE modification SYSTEM "http://www.simplemachines.org/xml/modification">
<modification xmlns="http://www.simplemachines.org/xml/modification" xmlns:smf="http://www.simplemachines.org/">
	<id>temar:EveAPI</id>
	<version>1.00</version>

	<file name="$sourcedir/Register.php">

		<operation>
			<search position="replace"><![CDATA[	// Lets check for other errors before trying to register the member.]]></search>
			<add><![CDATA[	global $eve_api;
	if($modSettings['eveapi_regreq'])
	{
		$chars = $eve_api -> get_characters($_POST['eveapi_user_id'][0], $_POST['eveapi_user_api'][0]);
		if(empty($chars)) // invalid api
			$reg_errors[] = $txt['eveapi_regreq_error'];
	}

	// Lets check for other errors before trying to register the member.]]></add>
		</operation>
		<operation>
			<search position="replace"><![CDATA[	$memberID = registerMember($regOptions, true);]]></search>
			<add><![CDATA[	$memberID = registerMember($regOptions, true);

	$eve_api -> EveApiAdd($memberID, true);]]></add>
		</operation>

	</file>

</modification>